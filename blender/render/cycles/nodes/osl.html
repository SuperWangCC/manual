

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>开放式着色语言 (OSL)–MASSA-Ultra(͡·̮̃·̃)翻译 &mdash; Blender Manual</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  

  

  
  
    
      <link rel="search" type="application/opensearchdescription+xml" title="在 Blender Manual 中搜索" href="../../../_static/opensearch.xml"/>
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../../_static/css/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="索引"
              href="../../../genindex.html"/>
        <link rel="search" title="搜索" href="../../../search.html"/>
    <link rel="top" title="Blender Manual" href="../../../index.html"/>
        <link rel="up" title="节点–leroy翻译" href="index.html"/>
        <link rel="next" title="Input Nodes" href="types/input/index.html"/>
        <link rel="prev" title="介绍–老猫" href="introduction.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../contents.html" class="icon icon-home"> Blender 2.78 Manual
          

          
            
            <img src="../../../_static/sidebar_logo.png" class="logo" />
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/index.html">Blender入门</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../interface/index.html">User Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../editors/index.html">编辑器</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data_system/index.html">数据系统</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modeling/index.html">制作模型</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sculpt_paint/index.html">绘制与雕刻</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rigging/index.html">骨骼装配</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../animation/index.html">动画</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../physics/index.html">物理</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">渲染</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../blender_render/index.html">Blender Render Engine</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Cycles Render Engine</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../introduction.html">简介</a></li>
<li class="toctree-l3"><a class="reference internal" href="../settings/index.html">渲染设置</a></li>
<li class="toctree-l3"><a class="reference internal" href="../materials/index.html">材质</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">节点&#8211;leroy翻译</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="introduction.html">介绍&#8211;老猫</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">开放式着色语言 (OSL)&#8211;MASSA-Ultra(͡·̮̃·̃)翻译</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#node-types">Node Types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../world.html">世界</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lamps.html">灯光</a></li>
<li class="toctree-l3"><a class="reference internal" href="../camera.html">摄像机</a></li>
<li class="toctree-l3"><a class="reference internal" href="../features.html">特性</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu_rendering.html">GPU渲染</a></li>
<li class="toctree-l3"><a class="reference internal" href="../baking.html">渲染烘焙&#8211;Leroy 翻译</a></li>
<li class="toctree-l3"><a class="reference internal" href="../optimizations/index.html">Optimizing Renders</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../output/index.html">Render Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../post_process/index.html">Post Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../freestyle/index.html">Freestyle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../workflows/index.html">Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../opengl.html">OpenGL Render</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../audio/index.html">Audio Rendering</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../compositing/index.html">合成</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../game_engine/index.html">游戏引擎</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../preferences/index.html">用户偏好设置</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../advanced/index.html">高级应用</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../troubleshooting/index.html">问题排查</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary/index.html">词汇表</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../about/index.html">关于本手册</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../contents.html">Blender 2.78 Manual</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../contents.html">Docs</a> &raquo;</li>
      
          <li><a href="../../index.html">渲染</a> &raquo;</li>
      
          <li><a href="../index.html">Cycles Render Engine</a> &raquo;</li>
      
          <li><a href="index.html">节点&#8211;leroy翻译</a> &raquo;</li>
      
    <li>开放式着色语言 (OSL)&#8211;MASSA-Ultra(͡·̮̃·̃)翻译</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/render/cycles/nodes/osl.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="open-shading-language">
<h1>开放式着色语言 (OSL)&#8211;MASSA-Ultra(͡·̮̃·̃)翻译<a class="headerlink" href="#open-shading-language" title="永久链接至标题">¶</a></h1>
<p>It is also possible to create your own nodes using
<a class="reference external" href="https://github.com/imageworks/OpenShadingLanguage">Open Shading Language</a> (OSL).
Note that these nodes will only work for CPU rendering;
there is no support for running OSL code on the GPU.</p>
<p>To enable it, select <em>Open Shading Language</em> as the shading system in the render settings.</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">在Linux上，C/C++ 编译工具（通常实践来说是/usr/bin/cpp）必须要安装来编译OSL脚本。</p>
</div>
<div class="section" id="script-node">
<h2>脚本节点<a class="headerlink" href="#script-node" title="永久链接至标题">¶</a></h2>
<p>OSL was designed for node-based shading,
and <em>each</em> OSL shader corresponds to <em>one</em> node in a node setup. To add an OSL shader,
add a script node and link it to a text data-block or an external file. Input and output
sockets will be created from the shader parameters on clicking the update button in the node
or the text editor.</p>
<p>OSL shaders can be linked to the node in a few different ways. With the <em>Internal</em> mode,
a text data-block is used to store the OSL shader,
and the OSO bytecode is stored in the node itself.
This is useful for distributing a blend-file with everything packed into it.</p>
<p>The <em>External</em> mode can be used to specify a <code class="docutils literal"><span class="pre">.osl</span></code> file on disk,
and this will then be automatically compiled into a <code class="docutils literal"><span class="pre">.oso</span></code> file in the same directory.
It is also possible to specify a path to a <code class="docutils literal"><span class="pre">.oso</span></code> file, which will then be used directly,
with compilation done manually by the user. The third option is to specify just the module name,
which will be looked up in the shader search path.</p>
<p>着色器的搜索地址可以在OSL脚本内所指定的地址下找到，如下：</p>
<dl class="docutils">
<dt>Linux</dt>
<dd><pre class="first last literal-block">
$HOME/.config/blender/2.78/shaders/
</pre>
</dd>
<dt>MS-Windows</dt>
<dd><pre class="first last literal-block">
C:\Users\$user\AppData\Roaming\Blender Foundation\Blender\2.78\shaders\
</pre>
</dd>
<dt>macOS</dt>
<dd><pre class="first last literal-block">
/Users/$USER/Library/Application Support/Blender/2.78/shaders/
</pre>
</dd>
</dl>
<div class="admonition tip">
<p class="first admonition-title">小技巧</p>
<p class="last">For use in production, we suggest to use a node group to wrap shader script nodes,
and link that into other blend-files.
This makes it easier to make changes to the node afterwards as sockets are added or removed,
without having to update the script nodes in all files.</p>
</div>
</div>
<div class="section" id="writing-shaders">
<h2>写着色器<a class="headerlink" href="#writing-shaders" title="永久链接至标题">¶</a></h2>
<p>For more details on how to write shaders, see the
<a class="reference external" href="https://github.com/imageworks/OpenShadingLanguage/blob/master/src/doc/osl-languagespec.pdf">OSL specification</a>.
Here is a simple example:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="n">shader</span> <span class="nf">simple_material</span><span class="p">(</span>
    <span class="n">color</span> <span class="n">Diffuse_Color</span> <span class="o">=</span> <span class="n">color</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">),</span>
    <span class="kt">float</span> <span class="n">Noise_Factor</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">output</span> <span class="n">closure</span> <span class="n">color</span> <span class="n">BSDF</span> <span class="o">=</span> <span class="n">diffuse</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="p">{</span>
    <span class="n">color</span> <span class="n">material_color</span> <span class="o">=</span> <span class="n">Diffuse_Color</span> <span class="o">*</span> <span class="n">mix</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">noise</span><span class="p">(</span><span class="n">P</span> <span class="o">*</span> <span class="mf">10.0</span><span class="p">),</span> <span class="n">Noise_Factor</span><span class="p">);</span>
    <span class="n">BSDF</span> <span class="o">=</span> <span class="n">material_color</span> <span class="o">*</span> <span class="n">diffuse</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="closures">
<h2>闭包<a class="headerlink" href="#closures" title="永久链接至标题">¶</a></h2>
<p>OSL 是不同的例如，RSL 或 GLSL，它没有光的循环。没有访问到场景中的灯光和材料必须由在渲染引擎本身实施的封锁。这是更多限制，但也使得渲染引擎做优化，确保所有着色器可以是重要性采样。</p>
<p>The available closures in Cycles correspond to the shader nodes and their sockets;
for more details on what they do and the meaning of the parameters,
see the <a class="reference internal" href="types/shaders/index.html"><span class="doc">shader nodes manual</span></a>.</p>
<div class="section" id="bsdf">
<h3>双向散射分布函数<a class="headerlink" href="#bsdf" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">diffuse(N)</span></code></li>
<li><code class="docutils literal"><span class="pre">oren_nayar(N,</span> <span class="pre">roughness)</span></code></li>
<li><code class="docutils literal"><span class="pre">diffuse_ramp(N,</span> <span class="pre">colors[8])</span></code></li>
<li><code class="docutils literal"><span class="pre">phong_ramp(N,</span> <span class="pre">exponent,</span> <span class="pre">colors[8])</span></code></li>
<li><code class="docutils literal"><span class="pre">diffuse_toon(N,</span> <span class="pre">size,</span> <span class="pre">smooth)</span></code></li>
<li><code class="docutils literal"><span class="pre">glossy_toon(N,</span> <span class="pre">size,</span> <span class="pre">smooth)</span></code></li>
<li><code class="docutils literal"><span class="pre">translucent(N)</span></code></li>
<li><code class="docutils literal"><span class="pre">reflection(N)</span></code></li>
<li><code class="docutils literal"><span class="pre">refraction(N,</span> <span class="pre">ior)</span></code></li>
<li><code class="docutils literal"><span class="pre">transparent()</span></code></li>
<li><code class="docutils literal"><span class="pre">microfacet_ggx(N,</span> <span class="pre">roughness)</span></code></li>
<li><code class="docutils literal"><span class="pre">microfacet_ggx_aniso(N,</span> <span class="pre">T,</span> <span class="pre">ax,</span> <span class="pre">ay)</span></code></li>
<li><code class="docutils literal"><span class="pre">microfacet_ggx_refraction(N,</span> <span class="pre">roughness,</span> <span class="pre">ior)</span></code></li>
<li><code class="docutils literal"><span class="pre">microfacet_beckmann(N,</span> <span class="pre">roughness)</span></code></li>
<li><code class="docutils literal"><span class="pre">microfacet_beckmann_aniso(N,</span> <span class="pre">T,</span> <span class="pre">ax,</span> <span class="pre">ay)</span></code></li>
<li><code class="docutils literal"><span class="pre">microfacet_beckmann_refraction(N,</span> <span class="pre">roughness,</span> <span class="pre">ior)</span></code></li>
<li><code class="docutils literal"><span class="pre">ashikhmin_shirley(N,</span> <span class="pre">T,</span> <span class="pre">ax,</span> <span class="pre">ay)</span></code></li>
<li><code class="docutils literal"><span class="pre">ashikhmin_velvet(N,</span> <span class="pre">roughness)</span></code></li>
</ul>
</div>
<div class="section" id="hair">
<h3>毛发<a class="headerlink" href="#hair" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">hair_reflection(N,</span> <span class="pre">roughnessu,</span> <span class="pre">roughnessv,</span> <span class="pre">T,</span> <span class="pre">offset)</span></code></li>
<li><code class="docutils literal"><span class="pre">hair_transmission(N,</span> <span class="pre">roughnessu,</span> <span class="pre">roughnessv,</span> <span class="pre">T,</span> <span class="pre">offset)</span></code></li>
</ul>
</div>
<div class="section" id="bssrdf">
<h3>双向散射面反射分布函数<a class="headerlink" href="#bssrdf" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">bssrdf_cubic(N,</span> <span class="pre">radius,</span> <span class="pre">texture_blur,</span> <span class="pre">sharpness)</span></code></li>
<li><code class="docutils literal"><span class="pre">bssrdf_gaussian(N,</span> <span class="pre">radius,</span> <span class="pre">texture_blur)</span></code></li>
</ul>
</div>
<div class="section" id="volume">
<h3>体积<a class="headerlink" href="#volume" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">henyey_greenstein(g)</span></code></li>
<li><code class="docutils literal"><span class="pre">absorption()</span></code></li>
</ul>
</div>
<div class="section" id="other">
<h3>其他<a class="headerlink" href="#other" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">emission()</span></code></li>
<li><code class="docutils literal"><span class="pre">ambient_occlusion()</span></code></li>
<li><code class="docutils literal"><span class="pre">holdout()</span></code></li>
<li><code class="docutils literal"><span class="pre">background()</span></code></li>
</ul>
</div>
</div>
<div class="section" id="attributes">
<h2>属性<a class="headerlink" href="#attributes" title="永久链接至标题">¶</a></h2>
<p>一些物件，粒子和模型属性也可以在自带的getattribute() 函数取得。 UV贴图和顶点颜色也可以通过他们的名字检索。其他属性如下：</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">geom:generated</span></code></dt>
<dd>Generated texture coordinates.</dd>
<dt><code class="docutils literal"><span class="pre">geom:uv</span></code></dt>
<dd>Default render UV map.</dd>
<dt><code class="docutils literal"><span class="pre">geom:dupli_generated</span></code></dt>
<dd>For instances, generated coordinate from duplicator object.</dd>
<dt><code class="docutils literal"><span class="pre">geom:dupli_uv</span></code></dt>
<dd>For instances, UV coordinate from duplicator object.</dd>
<dt><code class="docutils literal"><span class="pre">geom:trianglevertices</span></code></dt>
<dd>3 vertex coordinates of the triangle.</dd>
<dt><code class="docutils literal"><span class="pre">geom:numpolyvertices</span></code></dt>
<dd>Number of vertices in the polygon (always returns three currently).</dd>
<dt><code class="docutils literal"><span class="pre">geom:polyvertices</span></code></dt>
<dd>Vertex coordinates array of the polygon (always three vertices currently).</dd>
<dt><code class="docutils literal"><span class="pre">geom:name</span></code></dt>
<dd>Name of the object.</dd>
<dt><code class="docutils literal"><span class="pre">geom:is_curve</span></code></dt>
<dd>Is object a strand or not.</dd>
<dt><code class="docutils literal"><span class="pre">geom:curve_intercept</span></code></dt>
<dd>Point along the strand, from root to tip.</dd>
<dt><code class="docutils literal"><span class="pre">geom:curve_thickness</span></code></dt>
<dd>Thickness of the strand.</dd>
<dt><code class="docutils literal"><span class="pre">geom:curve_tangent_normal</span></code></dt>
<dd>Tangent Normal of the strand.</dd>
<dt><code class="docutils literal"><span class="pre">path:ray_length</span></code></dt>
<dd>Ray distance since last hit.</dd>
<dt><code class="docutils literal"><span class="pre">object:location</span></code></dt>
<dd>Object location.</dd>
<dt><code class="docutils literal"><span class="pre">object:index</span></code></dt>
<dd>Object index number.</dd>
<dt><code class="docutils literal"><span class="pre">object:random</span></code></dt>
<dd>Per object random number generated from object index and name.</dd>
<dt><code class="docutils literal"><span class="pre">material:index</span></code></dt>
<dd>Material index number.</dd>
<dt><code class="docutils literal"><span class="pre">particle:index</span></code></dt>
<dd>Particle instance number.</dd>
<dt><code class="docutils literal"><span class="pre">particle:age</span></code></dt>
<dd>Particle age in frames.</dd>
<dt><code class="docutils literal"><span class="pre">particle:lifetime</span></code></dt>
<dd>Total lifespan of particle in frames.</dd>
<dt><code class="docutils literal"><span class="pre">particle:location</span></code></dt>
<dd>Location of the particle.</dd>
<dt><code class="docutils literal"><span class="pre">particle:size</span></code></dt>
<dd>Size of the particle.</dd>
<dt><code class="docutils literal"><span class="pre">particle:velocity</span></code></dt>
<dd>Velocity of the particle.</dd>
<dt><code class="docutils literal"><span class="pre">particle:angular_velocity</span></code></dt>
<dd>Angular velocity of the particle.</dd>
</dl>
</div>
<div class="section" id="trace">
<h2>跟踪<a class="headerlink" href="#trace" title="永久链接至标题">¶</a></h2>
<p>我们支持从OSL着色器跟踪（点POS，矢量DIR..)函数去跟踪光线。着色参数目前还是不支持。但是属性可以从已击中的物件中利用``getmessage(&#8220;trace&#8221;, ..)``检索函数。请看看OSL规格。</p>
<p>This function cannot be used instead of lighting;
the main purpose is to allow shaders to &#8220;probe&#8221; nearby geometry,
for example to apply a projected texture that can be blocked by geometry,
apply more &#8220;wear&#8221; to exposed geometry, or make other ambient occlusion-like effects.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="types/input/index.html" class="btn btn-neutral float-right" title="Input Nodes" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="introduction.html" class="btn btn-neutral" title="介绍–老猫" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; 版权所有 : This page is licensed under a CC-BY-SA 4.0 Int. License.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'2.78',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-1418081-1', 'auto');
  ga('send', 'pageview');

</script>


</body>
</html>